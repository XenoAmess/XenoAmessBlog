---
title: 2021/3/21的修行
date: 2021-3-22 00:01:05
tags: [ '修行' ]
my: XenoAmess
---

### 1. 复盘2020/03/20的 HackThebox Retired 【Jerry】，梳理失误点

#### 1.1 gobuster滥用

实际上应该直接nmap出来是tomcat以后就上去草一下几个常用页面。

我当初的想法 是 很可能已经封了一些 所以直接gobuster看看有几个活着的

现在想想有点想多了

#### 1.2 tomcat猜密码不应该手动，而应该上弱密码库上自动化件直接爆破

#### 1.2.1 爆破脚本

（其实没什么技术含量 就是直接http了……）
但是写这里的话下次可以复（来）用（抄）

```python
#!/usr/bin/env python
import sys
import requests
with open('tomcat-betterdefaultpasslist.txt') as f:
for line in f:
c = line.strip('\n').split(":")
r = requests.get('http://10.10.10.95:8080/manager/html', auth=(c[0], c[1]))
if r.status_code == 200:
print "Found valid credentials \"" + line.strip('\n') + "\""
raise sys.exit()
```

#### 1.2.2 爆破密码库

#### 1.2.2.1 弱密码库SecLists

[github地址](https://github.com/danielmiessler/SecLists)

[Tomcat弱密码rawContentURL](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Passwords/Default-Credentials/tomcat-betterdefaultpasslist.txt)

#### 1.3 msf草上去以后，用 错 了！

Meterpreter不是reverse shell，应该用Meterpreter的命令才对啊啊啊啊啊啊！

这就是跳段的代价乡亲们

下面附上Meterpreter的CheatSheat

[Meterpreter Cheat Sheet](../resources/20210321修行/Meterpreter_cheat_sheet_v0.1.pdf)

所以我们其实msf草上去以后就可以了

后面的写jsp那块 这个靶机应该是不要求的

怪不得昨天我觉得怎么htb这 这么不友好 怎么新人上来入门就搞封指令的

23333

我的一个朋友称我为“脑补大师”。好吧 我确实经常想太多就是啦

人格特质如此

### 2. HackThebox Challenge 【You know 0xDiablos】 努力了，没打掉

简单搞了下 没思路 主要是 真的不会……

找了个第三方题解

https://gauravsachdev.github.io/2020/08/18/0xDiablos-HTB.html

#### 2.1 二分找缓冲区溢出点

```shell
python -c "print('A'*184)" | ./vuln
```

输入字符数量为184的时刚好溢出

#### 2.2 r2

```shell
r2 ./vuln
```

emmmmm后面的东西思路我看懂了，但是涉及汇编的东西 太过linux了，我的水平不够开这个坑

强行抄题解可以，但是那没有意义

留着吧，先去修行别的回来再学这个

而且pwn本身实战应用就少不是么

### 3. 塑形课

今天开了大课

十几个人跑跑跳跳……

稍微 有点过度热闹了

里面并没有任何可以称为同类的存在

明明身处人群 却感到 由衷的孤独感的我

……

不过这种事 我们也早就习惯了 不是么

### 4. HackThebox Challenge 【ScriptKiddie】 努力了，没打掉

#### 4.1 发现服务

先`nmap -v -A -Pn`扫出来5000有Werkzeug

```shell
nmap -v -A -Pn 10.129.95.150
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-03-21 22:01 CST
NSE: Loaded 153 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 22:01
Completed NSE at 22:01, 0.00s elapsed
Initiating NSE at 22:01
Completed NSE at 22:01, 0.00s elapsed
Initiating NSE at 22:01
Completed NSE at 22:01, 0.00s elapsed
Initiating Parallel DNS resolution of 1 host. at 22:01
Completed Parallel DNS resolution of 1 host. at 22:01, 0.01s elapsed
Initiating Connect Scan at 22:01
Scanning 10.129.95.150 [1000 ports]
Discovered open port 22/tcp on 10.129.95.150
Discovered open port 5000/tcp on 10.129.95.150
Increasing send delay for 10.129.95.150 from 0 to 5 due to 25 out of 83 dropped probes since last increase.
Increasing send delay for 10.129.95.150 from 5 to 10 due to max_successful_tryno increase to 4
Increasing send delay for 10.129.95.150 from 10 to 20 due to max_successful_tryno increase to 5
Connect Scan Timing: About 41.76% done; ETC: 22:02 (0:00:43 remaining)
Completed Connect Scan at 22:02, 76.17s elapsed (1000 total ports)
Initiating Service scan at 22:02
Scanning 2 services on 10.129.95.150
Completed Service scan at 22:03, 9.20s elapsed (2 services on 1 host)
NSE: Script scanning 10.129.95.150.
Initiating NSE at 22:03
Completed NSE at 22:03, 9.74s elapsed
Initiating NSE at 22:03
Completed NSE at 22:03, 1.94s elapsed
Initiating NSE at 22:03
Completed NSE at 22:03, 0.00s elapsed
Nmap scan report for 10.129.95.150
Host is up (0.23s latency).
Not shown: 998 closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 3c:65:6b:c2:df:b9:9d:62:74:27:a7:b8:a9:d3:25:2c (RSA)
|   256 b9:a1:78:5d:3c:1b:25:e0:3c:ef:67:8d:71:d3:a3:ec (ECDSA)                                                                                                                                                                                                     
|_  256 8b:cf:41:82:c6:ac:ef:91:80:37:7c:c9:45:11:e8:43 (ED25519)                                                                                                                                                                                                   
5000/tcp open  http    Werkzeug httpd 0.16.1 (Python 4.8.5)                                                                                                                                                                                                         
| http-methods:                                                                                                                                                                                                                                                     
|_  Supported Methods: OPTIONS GET POST HEAD                                                                                                                                                                                                                        
|_http-title: k1d'5 h4ck3r t00l5                                                                                                                                                                                                                                    
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                    
NSE: Script Post-scanning.                                                                                                                                                                                                                                          
Initiating NSE at 22:03                                                                                                                                                                                                                                             
Completed NSE at 22:03, 0.00s elapsed                                                                                                                                                                                                                               
Initiating NSE at 22:03                                                                                                                                                                                                                                             
Completed NSE at 22:03, 0.00s elapsed                                                                                                                                                                                                                               
Initiating NSE at 22:03                                                                                                                                                                                                                                             
Completed NSE at 22:03, 0.00s elapsed                                                                                                                                                                                                                               
Read data files from: /usr/bin/../share/nmap                                                                                                                                                                                                                        
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .                                                                                                                                                                      
Nmap done: 1 IP address (1 host up) scanned in 97.44 seconds         
```

去[cvedetails](www.cvedetails.com)找对应版本号的tomcat的cve

#### 4.2 找CVE

https://www.cvedetails.com/vulnerability-list/vendor_id-17201/product_id-41301/Palletsprojects-Werkzeug.html

获得：

```
CVE-2019-14806
CVE-2019-14322
CVE-2016-10516
```

但是可以利用版本都比对方机子上的版本低！烦诶！

#### 4.3 gobuster

那 上一个gobuster试试

`gobuster dir -u http://10.129.95.150:5000/ -w /usr/share/wordlists/dirbuster/directory-list-1.0.txt`

gobuster爆出//TODO

#### 4.4 找CVE

找openSSH的CVE.

8.2p1没找到任何

坏诶！

#### 4.5 考虑是否弱密码

不像

如果弱密码的话，分数不会这样

如果搞了这么多麻烦 结果只是个弱密码 那群基佬早就开骂了对吧

#### 4.6 考虑利用webshell

##### 上面两个栏

无法利用，因为执行shell之前做了IP合法性校验

这tm怎么玩 这没法玩

##### 最下面那个栏

做了特殊字符校验

三个栏只有这个能放非IP过去

只能想办法炸过去了对吧对吧

#### 4.7 摸校验方式

。。。

```shell
XenoAmess|whoami
XenoAmess&whoami
XenoAmess;whoami
```

全部被他校验掉了

而
```shell
whoami
```
过了，

```shell
1 2
```
也过了

所以问题不在空格和命令上 应该问题就是在特殊字符校验上

#### 4.8 学学searchsploit

因为本质上他就是在本地开了个searchsploit，
所以如果searchsploit上自己有带一些比较危险的玩具，
或许可以用来草开。

先从-h开始

如果-h能过，说明参数都能用。

```shell
-h
```
被校验掉了

淦，黔驴技穷黔驴技穷

认输了认输了

我已经try harder了，俺寻思现在放弃不算丢人
